# Image vectorizer with end to end transformers

## Methodology

### Generating data

I've downloaded 2 of my favourite, quite popular icons sets  

- [Tabler icons](https://tablericons.com/)
  - around 2500 icons in **outline** and **filled** variants giving alleged 5250 icons
- [Font awsome v6](https://fontawesome.com/)
  - **brands**, **regular** and **solid**, giving around 3000 icons

Cumulatively I gathered 8000 icons.

consider this:  

```svg
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
  <!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. -->
  <path
    d="M320 96V416C341.011 416 361.818 411.861 381.23 403.821C400.641 395.78 418.28 383.995 433.138 369.138C447.995 354.28 459.78 336.641 467.821 317.23C475.861 297.818 480 277.011 480 256C480 234.989 475.861 214.182 467.821 194.771C459.78 175.359 447.995 157.72 433.138 142.863C418.28 128.005 400.641 116.22 381.23 108.179C361.818 100.139 341.011 96 320 96ZM0 256L160.002 416L320.003 256L160.002 96L0 256ZM480 256C480 277.011 484.138 297.818 492.179 317.23C500.219 336.643 512.005 354.28 526.862 369.138C541.72 383.995 559.357 395.781 578.77 403.821C598.182 411.862 618.989 416 640 416V96C597.565 96 556.869 112.858 526.862 142.863C496.857 172.869 480 213.565 480 256Z" />
</svg>
```

The icons are firstly passed through a cleaning phase that:

- normalizes their viewport
- cleans the comments
- remove classes. (Classes are also mostly useless branding)

After 3 hours of regex, it turns out, SVG rescaling is a stupidly difficult task.  
I'm hugely thankful to **ddudan** and his [resize_svg.py](https://gist.github.com/dduan/251cb9816787f3e4125f5cb197d2144e) that makes my work  a oneliner.  

output now looks like:  

```svg
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="256" height="256">
  <path
    d="M128,48V208C136.4044,208 144.7272,205.9305 152.492,201.9105C160.2564,197.89 167.312,191.9975 173.2552,184.569C179.198,177.14 183.912,168.3205 187.1284,158.615C190.3444,148.909 192,138.5055 192,128C192,117.4945 190.3444,107.091 187.1284,97.3855C183.912,87.6795 179.198,78.86 173.2552,71.4315C167.312,64.0025 160.2564,58.11 152.492,54.0895C144.7272,50.0695 136.4044,48 128,48ZM0,128L64.0008,208L128.0012,128L64.0008,48L0,128ZM192,128C192,138.5055 193.6552,148.909 196.8716,158.615C200.0876,168.3215 204.802,177.14 210.7448,184.569C216.688,191.9975 223.7428,197.8905 231.508,201.9105C239.2728,205.931 247.5956,208 256,208V48C239.026,48 222.7476,56.429 210.7448,71.4315C198.7428,86.4345 192,106.7825 192,128Z" />
</svg>
```

Icons are saved in folder `clean_icons` which is .gitignored but can be regenerated by running `cleaner.py`

### Retraining a GPT2 on a bunch of SVGS

Firstly I need to make sure that I can train a model that is even remotely capable of understanding SVGs.  
I'm starting small. I have a `GTX 3060 12GB` which is enough to train some small models under `1B`.  

I'm training my own tokenizer and [GPT2-medium](https://huggingface.co/openai-community/gpt2-medium) to jut gnerate rndom SVGs.

## literature

[TrOCR: Transformer-based Optical Character Recognition with Pre-trained Models](https://arxiv.org/abs/2109.10282)